-- Super Fling GUI (Fast Catch + Persistent Target)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- GUI
local screenGui = Instance.new("ScreenGui", PlayerGui)
screenGui.Name = "FlingOrbitGUI"
screenGui.ResetOnSpawn = false

local mainFrame = Instance.new("Frame", screenGui)
mainFrame.Size = UDim2.new(0, 260, 0, 360)
mainFrame.Position = UDim2.new(0, 10, 0.4, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Instance.new("UICorner", mainFrame)

local toggleBtn = Instance.new("TextButton", mainFrame)
toggleBtn.Size = UDim2.new(1, -20, 0, 40)
toggleBtn.Position = UDim2.new(0, 10, 0, 10)
toggleBtn.Text = "Start Fling"
toggleBtn.BackgroundColor3 = Color3.fromRGB(0,170,255)
toggleBtn.TextColor3 = Color3.new(1,1,1)
toggleBtn.Font = Enum.Font.SourceSansBold
toggleBtn.TextSize = 16

local playerDropdown = Instance.new("TextButton", mainFrame)
playerDropdown.Size = UDim2.new(1, -20, 0, 30)
playerDropdown.Position = UDim2.new(0, 10, 0, 60)
playerDropdown.Text = "Select Player"
playerDropdown.BackgroundColor3 = Color3.fromRGB(50,50,50)
playerDropdown.TextColor3 = Color3.new(1,1,1)

local dropdownFrame = Instance.new("ScrollingFrame", mainFrame)
dropdownFrame.Size = UDim2.new(1, -20, 0, 90)
dropdownFrame.Position = UDim2.new(0, 10, 0, 95)
dropdownFrame.Visible = false
dropdownFrame.ScrollBarThickness = 6
Instance.new("UIListLayout", dropdownFrame)

local speedBox = Instance.new("TextBox", mainFrame)
speedBox.Size = UDim2.new(1, -20, 0, 20)
speedBox.Position = UDim2.new(0, 10, 0, 200)
speedBox.Text = "1500"
speedBox.BackgroundColor3 = Color3.fromRGB(50,50,50)
speedBox.TextColor3 = Color3.new(1,1,1)

local status = Instance.new("TextLabel", mainFrame)
status.Size = UDim2.new(1, -20, 0, 20)
status.Position = UDim2.new(0, 10, 0, 230)
status.Text = "Status: Idle"
status.TextColor3 = Color3.new(1,1,1)
status.BackgroundTransparency = 1
status.TextXAlignment = Enum.TextXAlignment.Left

-- =========================
-- TARGET TRACKING (UPGRADED)
-- =========================
local selectedPlayer
local selectedUserId
local trackedHRP
local lastTargetPos
local charConn

local function hookCharacter(char)
	trackedHRP = char:WaitForChild("HumanoidRootPart", 5)
	lastTargetPos = nil
end

local function trackPlayer(player)
	selectedPlayer = player
	selectedUserId = player.UserId
	trackedHRP = nil

	if charConn then charConn:Disconnect() end

	if player.Character then
		task.spawn(hookCharacter, player.Character)
	end

	charConn = player.CharacterAdded:Connect(function(char)
		task.wait(0.1)
		hookCharacter(char)
	end)
end

-- Re-lock when player rejoins
Players.PlayerAdded:Connect(function(p)
	if selectedUserId and p.UserId == selectedUserId then
		playerDropdown.Text = "Target: " .. p.Name
		trackPlayer(p)
		status.Text = "Status: Target Rejoined"
	end
end)

-- =========================
-- DROPDOWN
-- =========================
playerDropdown.MouseButton1Click:Connect(function()
	dropdownFrame.Visible = not dropdownFrame.Visible
end)

local function refreshDropdown()
	for _,c in ipairs(dropdownFrame:GetChildren()) do
		if c:IsA("TextButton") then c:Destroy() end
	end

	for _,p in ipairs(Players:GetPlayers()) do
		if p ~= LocalPlayer then
			local b = Instance.new("TextButton", dropdownFrame)
			b.Size = UDim2.new(1,0,0,24)
			b.Text = p.Name
			b.BackgroundColor3 = Color3.fromRGB(60,60,60)
			b.TextColor3 = Color3.new(1,1,1)

			b.MouseButton1Click:Connect(function()
				playerDropdown.Text = "Target: " .. p.Name
				trackPlayer(p)
				dropdownFrame.Visible = false
			end)
		end
	end
end

refreshDropdown()
Players.PlayerAdded:Connect(refreshDropdown)
Players.PlayerRemoving:Connect(refreshDropdown)

-- =========================
-- FLING (FASTER CATCH)
-- =========================
local flingConn

local function startFling()
	if not selectedPlayer then
		status.Text = "Status: No target"
		return
	end

	local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
	local hrp = char:WaitForChild("HumanoidRootPart")
	status.Text = "Status: Flinging"

	flingConn = RunService.Heartbeat:Connect(function(dt)
		if not trackedHRP then return end

		local angleSpeed = tonumber(speedBox.Text) or 1500
		local angle = tick() * math.rad(angleSpeed)
		local offset = Vector3.new(math.cos(angle)*5, 0, math.sin(angle)*5)
		char:PivotTo(CFrame.new(trackedHRP.Position + offset))

		hrp.AssemblyAngularVelocity = Vector3.new(9999,9999,9999)

		-- ðŸ”¥ FAST APPROACH (distance-scaled)
		local targetPos = trackedHRP.Position
		if lastTargetPos then
			local vel = (targetPos - lastTargetPos) / dt
			targetPos += vel * 0.15
		end
		lastTargetPos = trackedHRP.Position

		local dir = targetPos - hrp.Position
		local dist = dir.Magnitude
		if dist > 0 then
			local speed = math.clamp(200 + dist * 3, 200, 600)
			hrp.AssemblyLinearVelocity = dir.Unit * speed
		end
	end)
end

toggleBtn.MouseButton1Click:Connect(function()
	if flingConn then
		flingConn:Disconnect()
		flingConn = nil
		status.Text = "Status: Stopped"
		toggleBtn.Text = "Start Fling"
	else
		startFling()
		toggleBtn.Text = "Stop Fling"
	end
end)
