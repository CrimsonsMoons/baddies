--- Super Fling GUI with Camera Lock, Ultra Fast Orbit, Target Details, 2s Prediction

-- SERVICES
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- PLAYER / CAMERA
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local Camera = workspace.CurrentCamera

-- CONFIG
local PREDICTION_TIME = 2 -- seconds ahead

-- GUI SETUP
local screenGui = Instance.new("ScreenGui", PlayerGui)
screenGui.Name = "FlingOrbitGUI"
screenGui.ResetOnSpawn = false

local mainFrame = Instance.new("Frame", screenGui)
mainFrame.Size = UDim2.new(0, 260, 0, 360)
mainFrame.Position = UDim2.new(0, 10, 0.4, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 8)

local toggleBtn = Instance.new("TextButton", mainFrame)
toggleBtn.Size = UDim2.new(1, -20, 0, 40)
toggleBtn.Position = UDim2.new(0, 10, 0, 10)
toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
toggleBtn.Text = "Start Fling"
toggleBtn.TextColor3 = Color3.new(1,1,1)
toggleBtn.Font = Enum.Font.SourceSansBold
toggleBtn.TextSize = 16

local dropdownLabel = Instance.new("TextLabel", mainFrame)
dropdownLabel.Size = UDim2.new(1, -20, 0, 20)
dropdownLabel.Position = UDim2.new(0, 10, 0, 60)
dropdownLabel.Text = "Select Player:"
dropdownLabel.TextColor3 = Color3.new(1,1,1)
dropdownLabel.BackgroundTransparency = 1
dropdownLabel.TextXAlignment = Enum.TextXAlignment.Left

local playerDropdown = Instance.new("TextButton", mainFrame)
playerDropdown.Size = UDim2.new(1, -20, 0, 30)
playerDropdown.Position = UDim2.new(0, 10, 0, 85)
playerDropdown.BackgroundColor3 = Color3.fromRGB(50,50,50)
playerDropdown.Text = "Select Player"
playerDropdown.TextColor3 = Color3.new(1,1,1)

local dropdownFrame = Instance.new("ScrollingFrame", mainFrame)
dropdownFrame.Size = UDim2.new(1, -20, 0, 80)
dropdownFrame.Position = UDim2.new(0, 10, 0, 115)
dropdownFrame.BackgroundColor3 = Color3.fromRGB(35,35,35)
dropdownFrame.Visible = false
dropdownFrame.ScrollBarThickness = 6
dropdownFrame.CanvasSize = UDim2.new(0,0,0,0)

local layout = Instance.new("UIListLayout", dropdownFrame)
layout.Padding = UDim.new(0,2)

local speedSlider = Instance.new("TextBox", mainFrame)
speedSlider.Size = UDim2.new(1, -20, 0, 20)
speedSlider.Position = UDim2.new(0, 10, 0, 200)
speedSlider.BackgroundColor3 = Color3.fromRGB(50,50,50)
speedSlider.Text = "1500"
speedSlider.TextColor3 = Color3.new(1,1,1)
speedSlider.ClearTextOnFocus = false

local statusLabel = Instance.new("TextLabel", mainFrame)
statusLabel.Size = UDim2.new(1, -20, 0, 20)
statusLabel.Position = UDim2.new(0, 10, 0, 225)
statusLabel.Text = "Status: Idle"
statusLabel.TextColor3 = Color3.new(1,1,1)
statusLabel.BackgroundTransparency = 1
statusLabel.TextXAlignment = Enum.TextXAlignment.Left

local detailsLabel = Instance.new("TextLabel", mainFrame)
detailsLabel.Size = UDim2.new(1, -20, 0, 20)
detailsLabel.Position = UDim2.new(0, 10, 0, 245)
detailsLabel.Text = "Distance: N/A"
detailsLabel.TextColor3 = Color3.new(1,1,1)
detailsLabel.BackgroundTransparency = 1
detailsLabel.TextXAlignment = Enum.TextXAlignment.Left

local cameraLockToggle = Instance.new("TextButton", mainFrame)
cameraLockToggle.Size = UDim2.new(1, -20, 0, 20)
cameraLockToggle.Position = UDim2.new(0, 10, 0, 270)
cameraLockToggle.BackgroundColor3 = Color3.fromRGB(40,40,40)
cameraLockToggle.Text = "Camera Lock: OFF"
cameraLockToggle.TextColor3 = Color3.new(1,1,1)

local resetBtn = Instance.new("TextButton", mainFrame)
resetBtn.Size = UDim2.new(1, -20, 0, 20)
resetBtn.Position = UDim2.new(0, 10, 0, 295)
resetBtn.BackgroundColor3 = Color3.fromRGB(255,60,60)
resetBtn.Text = "Reset"
resetBtn.TextColor3 = Color3.new(1,1,1)

-- DRAGGING
local dragging, dragStart, startPos, dragInput
mainFrame.InputBegan:Connect(function(i)
	if i.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = i.Position
		startPos = mainFrame.Position
		i.Changed:Connect(function()
			if i.UserInputState == Enum.UserInputState.End then dragging = false end
		end)
	end
end)

mainFrame.InputChanged:Connect(function(i)
	if i.UserInputType == Enum.UserInputType.MouseMovement then
		dragInput = i
	end
end)

RunService.RenderStepped:Connect(function()
	if dragging and dragInput then
		local delta = dragInput.Position - dragStart
		mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
			startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)

-- PLAYER DROPDOWN
local selectedPlayer
playerDropdown.MouseButton1Click:Connect(function()
	dropdownFrame.Visible = not dropdownFrame.Visible
end)

local function refreshDropdown()
	for _,c in ipairs(dropdownFrame:GetChildren()) do
		if c:IsA("TextButton") then c:Destroy() end
	end
	for _,p in ipairs(Players:GetPlayers()) do
		if p ~= LocalPlayer then
			local b = Instance.new("TextButton", dropdownFrame)
			b.Size = UDim2.new(1,0,0,24)
			b.Text = p.Name
			b.BackgroundColor3 = Color3.fromRGB(60,60,60)
			b.TextColor3 = Color3.new(1,1,1)
			b.MouseButton1Click:Connect(function()
				selectedPlayer = p
				playerDropdown.Text = "Target: "..p.Name
				dropdownFrame.Visible = false
			end)
		end
	end
	dropdownFrame.CanvasSize = UDim2.new(0,0,0,layout.AbsoluteContentSize.Y)
end
refreshDropdown()
Players.PlayerAdded:Connect(refreshDropdown)
Players.PlayerRemoving:Connect(refreshDropdown)

-- CAMERA LOCK
local cameraLock = false
local cameraConn
cameraLockToggle.MouseButton1Click:Connect(function()
	cameraLock = not cameraLock
	cameraLockToggle.Text = "Camera Lock: "..(cameraLock and "ON" or "OFF")
	if not cameraLock and cameraConn then
		cameraConn:Disconnect()
		cameraConn = nil
	end
end)

-- FLING LOGIC (2s PREDICTION)
local flingConn
local function startFling()
	if not selectedPlayer then return end

	local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
	local hrp = char:WaitForChild("HumanoidRootPart")
	statusLabel.Text = "Status: Flinging "..selectedPlayer.Name

	if cameraLock then
		cameraConn = RunService.RenderStepped:Connect(function()
			if selectedPlayer.Character then
				local t = selectedPlayer.Character:FindFirstChild("HumanoidRootPart")
				if t then
					Camera.CameraSubject = t
					Camera.CFrame = CFrame.new(Camera.CFrame.Position, t.Position)
				end
			end
		end)
	end

	flingConn = RunService.Heartbeat:Connect(function()
		if not selectedPlayer.Character then return end
		local targetHRP = selectedPlayer.Character:FindFirstChild("HumanoidRootPart")
		if not targetHRP then return end

		local speed = tonumber(speedSlider.Text) or 1500
		local angle = tick() * math.rad(speed)

		-- ðŸ”® 2 SECOND PREDICTION
		local predictedPos =
			targetHRP.Position +
			(targetHRP.AssemblyLinearVelocity * PREDICTION_TIME)

		local offset = Vector3.new(math.cos(angle)*5, 0, math.sin(angle)*5)
		local spin = CFrame.Angles(angle, angle, angle)
		char:PivotTo(CFrame.new(predictedPos + offset) * spin)

		hrp.AssemblyAngularVelocity = Vector3.new(9999,9999,9999)
		hrp.AssemblyLinearVelocity = (predictedPos - hrp.Position).Unit * 200

		detailsLabel.Text =
			string.format("Distance: %.1f studs",
				(predictedPos - hrp.Position).Magnitude)
	end)
end

toggleBtn.MouseButton1Click:Connect(function()
	if flingConn then
		flingConn:Disconnect()
		flingConn = nil
		if cameraConn then cameraConn:Disconnect() end
		statusLabel.Text = "Status: Stopped"
		detailsLabel.Text = "Distance: N/A"
		toggleBtn.Text = "Start Fling"
	else
		startFling()
		toggleBtn.Text = "Stop Fling"
	end
end)

resetBtn.MouseButton1Click:Connect(function()
	screenGui:Destroy()
end)
